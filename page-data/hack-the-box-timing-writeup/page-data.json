{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/hack-the-box-timing-writeup",
    "result": {"data":{"post":{"slug":"/hack-the-box-timing-writeup","title":"Hack the Box Timing Writeup","date":"24.03.2022","tags":[{"name":"Timing","slug":"timing"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hack the Box Timing Writeup\",\n  \"date\": \"2022-03-24T00:00:00.000Z\",\n  \"tags\": [\"Timing\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h4\", null, \"Scan\"), \"First did basic port scanning using Rustscan to find open ports. ![Scan](./rust-scan.png)\", mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Hackthebox/Timing \\xBB nmap -p 22,80 -sCV 10.10.11.135\\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-03-24 16:54 GMT\\nNmap scan report for 10.10.11.135\\nHost is up (0.26s latency).\\n\\nPORT   STATE SERVICE VERSION\\n22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\\n| ssh-hostkey: \\n|   2048 d2:5c:40:d7:c9:fe:ff:a8:83:c3:6e:cd:60:11:d2:eb (RSA)\\n|   256 18:c9:f7:b9:27:36:a1:16:59:23:35:84:34:31:b3:ad (ECDSA)\\n|_  256 a2:2d:ee:db:4e:bf:f9:3f:8b:d4:cf:b4:12:d8:20:f2 (ED25519)\\n80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))\\n|_http-server-header: Apache/2.4.29 (Ubuntu)\\n| http-title: Simple WebApp\\n|_Requested resource was ./login.php\\n| http-cookie-flags: \\n|   /: \\n|     PHPSESSID: \\n|_      httponly flag not set\\nService Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel\\n\\n\")), mdx(\"p\", null, \"FUzzing\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Hackthebox/Timing \\xBB ffuf -w /usr/share/wordlists/dirb/common.txt -u http://timing.htb/FUZZ -fc 404\\n\\n        /'___\\\\  /'___\\\\           /'___\\\\       \\n       /\\\\ \\\\__/ /\\\\ \\\\__/  __  __  /\\\\ \\\\__/       \\n       \\\\ \\\\ ,__\\\\\\\\ \\\\ ,__\\\\/\\\\ \\\\/\\\\ \\\\ \\\\ \\\\ ,__\\\\      \\n        \\\\ \\\\ \\\\_/ \\\\ \\\\ \\\\_/\\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\ \\\\_/      \\n         \\\\ \\\\_\\\\   \\\\ \\\\_\\\\  \\\\ \\\\____/  \\\\ \\\\_\\\\       \\n          \\\\/_/    \\\\/_/   \\\\/___/    \\\\/_/       \\n\\n       v1.3.1 Kali Exclusive <3\\n________________________________________________\\n\\n :: Method           : GET\\n :: URL              : http://timing.htb/FUZZ\\n :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/common.txt\\n :: Follow redirects : false\\n :: Calibration      : false\\n :: Timeout          : 10\\n :: Threads          : 40\\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405\\n :: Filter           : Response status: 404\\n________________________________________________\\n\\n.htaccess               [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htpasswd               [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.hta                    [Status: 403, Size: 275, Words: 20, Lines: 10]\\n                        [Status: 302, Size: 0, Words: 1, Lines: 1]\\ncss                     [Status: 301, Size: 306, Words: 20, Lines: 10]\\nimages                  [Status: 301, Size: 309, Words: 20, Lines: 10]\\nindex.php               [Status: 302, Size: 0, Words: 1, Lines: 1]\\njs                      [Status: 301, Size: 305, Words: 20, Lines: 10]\\nserver-status           [Status: 403, Size: 275, Words: 20, Lines: 10]\\n\")), mdx(\"p\", null, \"Next Scan\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Hackthebox/Timing \\xBB ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-files.txt -u http://timing.htb/FUZZ -fc 404 \\n\\n        /'___\\\\  /'___\\\\           /'___\\\\       \\n       /\\\\ \\\\__/ /\\\\ \\\\__/  __  __  /\\\\ \\\\__/       \\n       \\\\ \\\\ ,__\\\\\\\\ \\\\ ,__\\\\/\\\\ \\\\/\\\\ \\\\ \\\\ \\\\ ,__\\\\      \\n        \\\\ \\\\ \\\\_/ \\\\ \\\\ \\\\_/\\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\ \\\\_/      \\n         \\\\ \\\\_\\\\   \\\\ \\\\_\\\\  \\\\ \\\\____/  \\\\ \\\\_\\\\       \\n          \\\\/_/    \\\\/_/   \\\\/___/    \\\\/_/       \\n\\n       v1.3.1 Kali Exclusive <3\\n________________________________________________\\n\\n :: Method           : GET\\n :: URL              : http://timing.htb/FUZZ\\n :: Wordlist         : FUZZ: /usr/share/wordlists/SecLists/Discovery/Web-Content/raft-small-files.txt\\n :: Follow redirects : false\\n :: Calibration      : false\\n :: Timeout          : 10\\n :: Threads          : 40\\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405\\n :: Filter           : Response status: 404\\n________________________________________________\\n\\nheader.php              [Status: 302, Size: 0, Words: 1, Lines: 1]\\nfooter.php              [Status: 200, Size: 3937, Words: 1307, Lines: 116]\\n.htaccess               [Status: 403, Size: 275, Words: 20, Lines: 10]\\nlogout.php              [Status: 302, Size: 0, Words: 1, Lines: 1]\\nindex.php               [Status: 302, Size: 0, Words: 1, Lines: 1]\\nlogin.php               [Status: 200, Size: 5609, Words: 1755, Lines: 178]\\n.                       [Status: 302, Size: 0, Words: 1, Lines: 1]\\nupload.php              [Status: 302, Size: 0, Words: 1, Lines: 1]\\n.html                   [Status: 403, Size: 275, Words: 20, Lines: 10]\\nprofile.php             [Status: 302, Size: 0, Words: 1, Lines: 1]\\n.php                    [Status: 403, Size: 275, Words: 20, Lines: 10]\\nimage.php               [Status: 200, Size: 0, Words: 1, Lines: 1]\\n.htpasswd               [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htm                    [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htpasswds              [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htgroup                [Status: 403, Size: 275, Words: 20, Lines: 10]\\nwp-forum.phps           [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htaccess.bak           [Status: 403, Size: 275, Words: 20, Lines: 10]\\n.htuser                 [Status: 403, Size: 275, Words: 20, Lines: 10]\\n\")), mdx(\"p\", null, \"Found \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"img\"), \" query parameter in image.php file. On searching found \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/\"\n  }, \"this\"), \" blog. Using wrapper php LFI I was able to access files in the host system.\\nFrom /etc/passwd found the username of user on the host system - \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"aaron\"), \".\\nTried to access aaron's home directory but no success. Then after some random files, I thought to look into php files of the website. I first went through most interesting one in hope to find the password - \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"login.php\"), \". I found nothing on plain sight. On opening source code, there were commented sections, and first was which gave the key. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"<!--?php\\n\\ninclude \\\"header.php\\\";\\n\\nfunction createTimeChannel()\\n{\\n    sleep(1);\\n}\\n\\ninclude \\\"db_conn.php\\\";\\n\\nif (isset($_SESSION['userid'])){\\n    header('Location: ./index.php');\\n    die();\\n}\\n\\n\\nif (isset($_GET['login'])) {\\n    $username = $_POST['user'];\\n    $password = $_POST['password'];\\n\\n    $statement = $pdo--->\\n\\n\")), mdx(\"p\", null, \"It is referring to some \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"db_conn.php\"), \" file in the same directory. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"<!--?php\\n$pdo = new PDO('mysql:host=localhost;dbname=app', 'root', '4_V3Ry_l0000n9_p422w0rd');\\n-->\\n\")), mdx(\"p\", null, \"Image.php\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"<!--?php\\n\\nfunction is_safe_include($text)\\n{\\n    $blacklist = array(\\\"php://input\\\", \\\"phar://\\\", \\\"zip://\\\", \\\"ftp://\\\", \\\"file://\\\", \\\"http://\\\", \\\"data://\\\", \\\"expect://\\\", \\\"https://\\\", \\\"../\\\");\\n\\n    foreach ($blacklist as $item) {\\n        if (strpos($text, $item) !== false) {\\n            return false;\\n        }\\n    }\\n    return substr($text, 0, 1) !== \\\"/\\\";\\n\\n}\\n\\nif (isset($_GET['img'])) {\\n    if (is_safe_include($_GET['img'])) {\\n        include($_GET['img']);\\n    } else {\\n        echo \\\"Hacking attempt detected!\\\";\\n    }\\n}\\n-->\\n\")), mdx(\"p\", null, \"upload.php\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"<!--?php\\ninclude(\\\"admin_auth_check.php\\\");\\n\\n$upload_dir = \\\"images/uploads/\\\";\\n\\nif (!file_exists($upload_dir)) {\\n    mkdir($upload_dir, 0777, true);\\n}\\n\\n$file_hash = uniqid();\\n\\n$file_name = md5('$file_hash' . time()) . '_' . basename($_FILES[\\\"fileToUpload\\\"][\\\"name\\\"]);\\n$target_file = $upload_dir . $file_name;\\n$error = \\\"\\\";\\n$imageFileType = strtolower(pathinfo($target_file, PATHINFO_EXTENSION));\\n\\nif (isset($_POST[\\\"submit\\\"])) {\\n    $check = getimagesize($_FILES[\\\"fileToUpload\\\"][\\\"tmp_name\\\"]);\\n    if ($check === false) {\\n        $error = \\\"Invalid file\\\";\\n    }\\n}\\n\\n// Check if file already exists\\nif (file_exists($target_file)) {\\n    $error = \\\"Sorry, file already exists.\\\";\\n}\\n\\nif ($imageFileType != \\\"jpg\\\") {\\n    $error = \\\"This extension is not allowed.\\\";\\n}\\n\\nif (empty($error)) {\\n    if (move_uploaded_file($_FILES[\\\"fileToUpload\\\"][\\\"tmp_name\\\"], $target_file)) {\\n        echo \\\"The file has been uploaded.\\\";\\n    } else {\\n        echo \\\"Error: There was an error uploading your file.\\\";\\n    }\\n} else {\\n    echo \\\"Error: \\\" . $error;\\n}\\n?-->\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"FUzzing Next Scan Found  img  query parameter in image.php file. On searching found  this  blog. Using wrapper php LFI I was able to access…","timeToRead":1,"banner":null}},"pageContext":{"slug":"/hack-the-box-timing-writeup","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}